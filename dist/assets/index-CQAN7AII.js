import{aF as b,bw as ce,aJ as j,s as g,Q as x,R as B,Z as te,_ as ne,a as se,r as U,t as R,j as h,aj as ue,a4 as q,I as ie,p as le,b as de,d as fe,g as ve,o as pe,c8 as Ee,l as be}from"./index-CWPIZKcJ.js";const Te=(e,t)=>{if(!b)return!1;const n={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(t)],s=ce(e,n);return["scroll","auto","overlay"].some(r=>s.includes(r))},Ke=(e,t)=>{if(!b)return;let n=e;for(;n;){if([window,document,document.documentElement].includes(n))return window;if(Te(n,t))return n;n=n.parentNode}return n};let F;const $e=e=>{var t;if(!b)return 0;if(F!==void 0)return F;const n=document.createElement("div");n.className=`${e}-scrollbar__wrap`,n.style.visibility="hidden",n.style.width="100px",n.style.position="absolute",n.style.top="-9999px",document.body.appendChild(n);const s=n.offsetWidth;n.style.overflow="scroll";const r=document.createElement("div");r.style.width="100%",n.appendChild(r);const c=r.offsetWidth;return(t=n.parentNode)==null||t.removeChild(n),F=s-c,F};function De(e,t){if(!b)return;if(!t){e.scrollTop=0;return}const n=[];let s=t.offsetParent;for(;s!==null&&e!==s&&e.contains(s);)n.push(s),s=s.offsetParent;const r=t.offsetTop+n.reduce((T,m)=>T+m.offsetTop,0),c=r+t.offsetHeight,d=e.scrollTop,p=d+e.clientHeight;r<d?e.scrollTop=r:c>p&&(e.scrollTop=c-e.clientHeight)}const me='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',ye=e=>getComputedStyle(e).position==="fixed"?!1:e.offsetParent!==null,He=e=>Array.from(e.querySelectorAll(me)).filter(t=>oe(t)&&ye(t)),oe=e=>{if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.tabIndex<0||e.hasAttribute("disabled")||e.getAttribute("aria-disabled")==="true")return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return!(e.type==="hidden"||e.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},Ve=function(e,t,...n){let s;t.includes("mouse")||t.includes("click")?s="MouseEvents":t.includes("key")?s="KeyboardEvent":s="HTMLEvents";const r=document.createEvent(s);return r.initEvent(t,...n),e.dispatchEvent(r),e},I="focus-trap.focus-after-trapped",k="focus-trap.focus-after-released",he="focus-trap.focusout-prevented",J={cancelable:!0,bubbles:!1},Fe={cancelable:!0,bubbles:!1},Q="focusAfterTrapped",X="focusAfterReleased",we=Symbol("elFocusTrap"),K=g(),P=g(0),$=g(0);let w=0;const re=e=>{const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0||s===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t},Y=(e,t)=>{for(const n of e)if(!_e(n,t))return n},_e=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},Se=e=>{const t=re(e),n=Y(t,e),s=Y(t.reverse(),e);return[n,s]},ge=e=>e instanceof HTMLInputElement&&"select"in e,v=(e,t)=>{if(e&&e.focus){const n=document.activeElement;let s=!1;j(e)&&!oe(e)&&!e.getAttribute("tabindex")&&(e.setAttribute("tabindex","-1"),s=!0),e.focus({preventScroll:!0}),$.value=window.performance.now(),e!==n&&ge(e)&&t&&e.select(),j(e)&&s&&e.removeAttribute("tabindex")}};function Z(e,t){const n=[...e],s=e.indexOf(t);return s!==-1&&n.splice(s,1),n}const Pe=()=>{let e=[];return{push:s=>{const r=e[0];r&&s!==r&&r.pause(),e=Z(e,s),e.unshift(s)},remove:s=>{var r,c;e=Z(e,s),(c=(r=e[0])==null?void 0:r.resume)==null||c.call(r)}}},Le=(e,t=!1)=>{const n=document.activeElement;for(const s of e)if(v(s,t),document.activeElement!==n)return},z=Pe(),Ce=()=>P.value>$.value,_=()=>{K.value="pointer",P.value=window.performance.now()},G=()=>{K.value="keyboard",P.value=window.performance.now()},Ae=()=>(x(()=>{w===0&&(document.addEventListener("mousedown",_),document.addEventListener("touchstart",_),document.addEventListener("keydown",G)),w++}),B(()=>{w--,w<=0&&(document.removeEventListener("mousedown",_),document.removeEventListener("touchstart",_),document.removeEventListener("keydown",G))}),{focusReason:K,lastUserFocusTimestamp:P,lastAutomatedFocusTimestamp:$}),S=e=>new CustomEvent(he,{...Fe,detail:e});let E=[];const ee=e=>{e.code===te.esc&&E.forEach(t=>t(e))},Oe=e=>{x(()=>{E.length===0&&document.addEventListener("keydown",ee),b&&E.push(e)}),B(()=>{E=E.filter(t=>t!==e),E.length===0&&b&&document.removeEventListener("keydown",ee)})},Ne=se({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[Q,X,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const n=g();let s,r;const{focusReason:c}=Ae();Oe(o=>{e.trapped&&!d.paused&&t("release-requested",o)});const d={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},p=o=>{if(!e.loop&&!e.trapped||d.paused)return;const{code:a,altKey:u,ctrlKey:i,metaKey:l,currentTarget:V,shiftKey:W}=o,{loop:M}=e,ae=a===te.tab&&!u&&!i&&!l,y=document.activeElement;if(ae&&y){const A=V,[O,N]=Se(A);if(O&&N){if(!W&&y===N){const f=S({focusReason:c.value});t("focusout-prevented",f),f.defaultPrevented||(o.preventDefault(),M&&v(O,!0))}else if(W&&[O,A].includes(y)){const f=S({focusReason:c.value});t("focusout-prevented",f),f.defaultPrevented||(o.preventDefault(),M&&v(N,!0))}}else if(y===A){const f=S({focusReason:c.value});t("focusout-prevented",f),f.defaultPrevented||o.preventDefault()}}};le(we,{focusTrapRef:n,onKeydown:p}),R(()=>e.focusTrapEl,o=>{o&&(n.value=o)},{immediate:!0}),R([n],([o],[a])=>{o&&(o.addEventListener("keydown",p),o.addEventListener("focusin",L),o.addEventListener("focusout",C)),a&&(a.removeEventListener("keydown",p),a.removeEventListener("focusin",L),a.removeEventListener("focusout",C))});const T=o=>{t(Q,o)},m=o=>t(X,o),L=o=>{const a=h(n);if(!a)return;const u=o.target,i=o.relatedTarget,l=u&&a.contains(u);e.trapped||i&&a.contains(i)||(s=i),l&&t("focusin",o),!d.paused&&e.trapped&&(l?r=u:v(r,!0))},C=o=>{const a=h(n);if(!(d.paused||!a))if(e.trapped){const u=o.relatedTarget;!ue(u)&&!a.contains(u)&&setTimeout(()=>{if(!d.paused&&e.trapped){const i=S({focusReason:c.value});t("focusout-prevented",i),i.defaultPrevented||v(r,!0)}},0)}else{const u=o.target;u&&a.contains(u)||t("focusout",o)}};async function D(){await q();const o=h(n);if(o){z.push(d);const a=o.contains(document.activeElement)?s:document.activeElement;if(s=a,!o.contains(a)){const i=new Event(I,J);o.addEventListener(I,T),o.dispatchEvent(i),i.defaultPrevented||q(()=>{let l=e.focusStartEl;ie(l)||(v(l),document.activeElement!==l&&(l="first")),l==="first"&&Le(re(o),!0),(document.activeElement===a||l==="container")&&v(o)})}}}function H(){const o=h(n);if(o){o.removeEventListener(I,T);const a=new CustomEvent(k,{...J,detail:{focusReason:c.value}});o.addEventListener(k,m),o.dispatchEvent(a),!a.defaultPrevented&&(c.value=="keyboard"||!Ce()||o.contains(document.activeElement))&&v(s??document.body),o.removeEventListener(k,m),z.remove(d)}}return x(()=>{e.trapped&&D(),R(()=>e.trapped,o=>{o?D():H()})}),B(()=>{e.trapped&&H(),n.value&&(n.value.removeEventListener("keydown",p),n.value.removeEventListener("focusin",L),n.value.removeEventListener("focusout",C),n.value=void 0)}),{onKeydown:p}}});function Re(e,t,n,s,r,c){return U(e.$slots,"default",{handleKeydown:e.onKeydown})}var We=ne(Ne,[["render",Re],["__file","focus-trap.vue"]]);const Ie=de({to:{type:fe([String,Object]),required:!0},disabled:Boolean}),ke=se({__name:"teleport",props:Ie,setup(e){return(t,n)=>t.disabled?U(t.$slots,"default",{key:0}):(pe(),ve(Ee,{key:1,to:t.to},[U(t.$slots,"default")],8,["to"]))}});var Ue=ne(ke,[["__file","teleport.vue"]]);const Me=be(Ue);export{We as E,we as F,Me as a,v as b,Ke as c,$e as g,oe as i,He as o,De as s,Ve as t};
